<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>pairing.primRec</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library pairing.primRec</h1>

<div class="code">
</div>

<div class="doc">
This code is part of Russell O'Connor's formalisation of Goedel's
   Incompleteness Theorem in Coq, released into the Public Domain.

<br/> <br/>
   http://r6.ca/Goedel/goedel1.html

</div>
<div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Arith</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Peano_dec</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Compare_dec</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Coq.Lists.List</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Eqdep_dec</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">extEqualNat</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Bvector</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">misc</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <span class="id" type="var">Bool</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <span class="id" type="var">EqNat</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Even</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <span class="id" type="var">Max</span>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <span class="id" type="var">PrimRec</span> : <span class="id" type="var">nat</span> → <span class="id" type="keyword">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id" type="var">succFunc</span> : <span class="id" type="var">PrimRec</span> 1<br/>
&nbsp;&nbsp;| <span class="id" type="var">zeroFunc</span> : <span class="id" type="var">PrimRec</span> 0<br/>
&nbsp;&nbsp;| <span class="id" type="var">projFunc</span> : ∀ <span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">m</span> &lt; <span class="id" type="var">n</span> → <span class="id" type="var">PrimRec</span> <span class="id" type="var">n</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">composeFunc</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">g</span> : <span class="id" type="var">PrimRecs</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span>) (<span class="id" type="var">h</span> : <span class="id" type="var">PrimRec</span> <span class="id" type="var">m</span>), <span class="id" type="var">PrimRec</span> <span class="id" type="var">n</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">primRecFunc</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">g</span> : <span class="id" type="var">PrimRec</span> <span class="id" type="var">n</span>) (<span class="id" type="var">h</span> : <span class="id" type="var">PrimRec</span> (<span class="id" type="var">S</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>))), <span class="id" type="var">PrimRec</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>)<br/>
<span class="id" type="keyword">with</span> <span class="id" type="var">PrimRecs</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="keyword">Set</span> :=<br/>
&nbsp;&nbsp;| <span class="id" type="var">PRnil</span> : ∀ <span class="id" type="var">n</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">PrimRecs</span> <span class="id" type="var">n</span> 0<br/>
&nbsp;&nbsp;| <span class="id" type="var">PRcons</span> : ∀ <span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">PrimRec</span> <span class="id" type="var">n</span> → <span class="id" type="var">PrimRecs</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> → <span class="id" type="var">PrimRecs</span> <span class="id" type="var">n</span> (<span class="id" type="var">S</span> <span class="id" type="var">m</span>).<br/>

<br/>
<span class="id" type="keyword">Scheme</span> <span class="id" type="var">PrimRec_PrimRecs_rec</span> := <span class="id" type="keyword">Induction</span> <span class="id" type="keyword">for</span> <span class="id" type="var">PrimRec</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">Sort</span> <span class="id" type="keyword">Set</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">PrimRecs_PrimRec_rec</span> := <span class="id" type="keyword">Induction</span> <span class="id" type="keyword">for</span> <span class="id" type="var">PrimRecs</span> <br/>
&nbsp;&nbsp;<span class="id" type="keyword">Sort</span> <span class="id" type="keyword">Set</span>.<br/>

<br/>
<span class="id" type="keyword">Scheme</span> <span class="id" type="var">PrimRec_PrimRecs_ind</span> := <span class="id" type="keyword">Induction</span> <span class="id" type="keyword">for</span> <span class="id" type="var">PrimRec</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">Sort</span> <span class="id" type="keyword">Prop</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">PrimRecs_PrimRec_ind</span> := <span class="id" type="keyword">Induction</span> <span class="id" type="keyword">for</span> <span class="id" type="var">PrimRecs</span> <br/>
&nbsp;&nbsp;<span class="id" type="keyword">Sort</span> <span class="id" type="keyword">Prop</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">evalConstFunc</span> (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">n</span>} : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">return</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">O</span> ⇒ <span class="id" type="var">m</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n'</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">evalConstFunc</span> <span class="id" type="var">n'</span> <span class="id" type="var">m</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">evalProjFunc</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) : ∀ <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">m</span> &lt; <span class="id" type="var">n</span> → <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">return</span> (∀ <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">m</span> &lt; <span class="id" type="var">n</span> → <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">O</span> ⇒ <span class="id" type="keyword">fun</span> (<span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l</span> : <span class="id" type="var">m</span> &lt; 0) ⇒ <span class="id" type="var">False_rec</span> <span class="id" type="var">_</span> (<span class="id" type="var">lt_n_O</span> <span class="id" type="var">_</span> <span class="id" type="var">l</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> (<span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l</span> : <span class="id" type="var">m</span> &lt; <span class="id" type="var">S</span> <span class="id" type="var">n'</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">eq_nat_dec</span> <span class="id" type="var">m</span> <span class="id" type="var">n'</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">left</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">evalConstFunc</span> <span class="id" type="var">_</span> <span class="id" type="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">right</span> <span class="id" type="var">l1</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">evalProjFunc</span> <span class="id" type="var">n'</span> <span class="id" type="var">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">le_lt_or_eq</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">lt_n_Sm_le</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">l</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">or_introl</span> <span class="id" type="var">l2</span> ⇒ <span class="id" type="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">or_intror</span> <span class="id" type="var">l2</span> ⇒ <span class="id" type="var">False_ind</span> <span class="id" type="var">_</span> (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">evalProjFuncInd</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">p1</span> <span class="id" type="var">p2</span> : <span class="id" type="var">m</span> &lt; <span class="id" type="var">n</span>),<br/>
&nbsp;<span class="id" type="var">evalProjFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">p1</span> = <span class="id" type="var">evalProjFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">p2</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">evalList</span> (<span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l</span> : <span class="id" type="var">vector</span> <span class="id" type="var">nat</span> <span class="id" type="var">m</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">l</span>} :<br/>
&nbsp;<span class="id" type="var">naryFunc</span> <span class="id" type="var">m</span> → <span class="id" type="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">in</span> (<span class="id" type="var">vector</span> <span class="id" type="var">_</span> <span class="id" type="var">m</span>) <span class="id" type="keyword">return</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">m</span> → <span class="id" type="var">nat</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">Vnil</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">naryFunc</span> 0 ⇒ <span class="id" type="var">x</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">Vcons</span> <span class="id" type="var">a</span> <span class="id" type="var">n</span> <span class="id" type="var">l'</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) ⇒ <span class="id" type="var">evalList</span> <span class="id" type="var">n</span> <span class="id" type="var">l'</span> (<span class="id" type="var">x</span> <span class="id" type="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">evalOneParamList</span> (<span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">a</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>)) <span class="id" type="var">m</span>)<br/>
&nbsp;{<span class="id" type="keyword">struct</span> <span class="id" type="var">l</span>} : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">in</span> (<span class="id" type="var">vector</span> <span class="id" type="var">_</span> <span class="id" type="var">m</span>) <span class="id" type="keyword">return</span> (<span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">Vnil</span> ⇒ <span class="id" type="var">Vnil</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">Vcons</span> <span class="id" type="var">f</span> <span class="id" type="var">m'</span> <span class="id" type="var">l'</span> ⇒ <span class="id" type="var">Vcons</span> <span class="id" type="var">_</span> (<span class="id" type="var">f</span> <span class="id" type="var">a</span>) <span class="id" type="var">m'</span> (<span class="id" type="var">evalOneParamList</span> <span class="id" type="var">n</span> <span class="id" type="var">m'</span> <span class="id" type="var">a</span> <span class="id" type="var">l'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">evalComposeFunc</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) :<br/>
&nbsp;∀ <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span> → <span class="id" type="var">naryFunc</span> <span class="id" type="var">m</span> → <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">return</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(∀ <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span> → <span class="id" type="var">naryFunc</span> <span class="id" type="var">m</span> → <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">O</span> ⇒ <span class="id" type="var">evalList</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> (<span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n'</span>)) <span class="id" type="var">m</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">f</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">m</span>) (<span class="id" type="var">a</span> : <span class="id" type="var">nat</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">n'</span> <span class="id" type="var">m</span> (<span class="id" type="var">evalOneParamList</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">a</span> <span class="id" type="var">l</span>) <span class="id" type="var">f</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">compose2</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span> → <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) → <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">return</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span> → <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) → <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">O</span> ⇒ <span class="id" type="keyword">fun</span> (<span class="id" type="var">a</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>) ⇒ <span class="id" type="var">g</span> <span class="id" type="var">a</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> (<span class="id" type="var">f</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n'</span>)) (<span class="id" type="var">g</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> (<span class="id" type="var">S</span> <span class="id" type="var">n'</span>))) (<span class="id" type="var">a</span> : <span class="id" type="var">nat</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">compose2</span> <span class="id" type="var">n'</span> (<span class="id" type="var">f</span> <span class="id" type="var">a</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">x</span> <span class="id" type="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">evalPrimRecFunc</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">g</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <br/>
&nbsp;(<span class="id" type="var">h</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>))) (<span class="id" type="var">a</span> : <span class="id" type="var">nat</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">a</span>} : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">a</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">O</span> ⇒ <span class="id" type="var">g</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">a'</span> ⇒ <span class="id" type="var">compose2</span> <span class="id" type="var">_</span> (<span class="id" type="var">evalPrimRecFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">g</span> <span class="id" type="var">h</span> <span class="id" type="var">a'</span>) (<span class="id" type="var">h</span> <span class="id" type="var">a'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">evalPrimRec</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">PrimRec</span> <span class="id" type="var">n</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">f</span>} : <br/>
&nbsp;<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">f</span> <span class="id" type="keyword">in</span> (<span class="id" type="var">PrimRec</span> <span class="id" type="var">n</span>) <span class="id" type="keyword">return</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">succFunc</span> ⇒ <span class="id" type="var">S</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">zeroFunc</span> ⇒ 0<br/>
&nbsp;&nbsp;| <span class="id" type="var">projFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">pf</span> ⇒ <span class="id" type="var">evalProjFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">pf</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">composeFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">l</span> <span class="id" type="var">f</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> (<span class="id" type="var">evalPrimRecs</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">l</span>) (<span class="id" type="var">evalPrimRec</span> <span class="id" type="var">_</span> <span class="id" type="var">f</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">primRecFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">g</span> <span class="id" type="var">h</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">evalPrimRecFunc</span> <span class="id" type="var">n</span> (<span class="id" type="var">evalPrimRec</span> <span class="id" type="var">_</span> <span class="id" type="var">g</span>) (<span class="id" type="var">evalPrimRec</span> <span class="id" type="var">_</span> <span class="id" type="var">h</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;<br/>
&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">evalPrimRecs</span> (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">fs</span> : <span class="id" type="var">PrimRecs</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">fs</span>} :<br/>
&nbsp;<span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">fs</span> <span class="id" type="keyword">in</span> (<span class="id" type="var">PrimRecs</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span>) <span class="id" type="keyword">return</span> (<span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">PRnil</span> <span class="id" type="var">a</span> ⇒ <span class="id" type="var">Vnil</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">a</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">PRcons</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">g</span> <span class="id" type="var">gs</span> ⇒ <span class="id" type="var">Vcons</span> <span class="id" type="var">_</span> (<span class="id" type="var">evalPrimRec</span> <span class="id" type="var">_</span> <span class="id" type="var">g</span>) <span class="id" type="var">_</span> (<span class="id" type="var">evalPrimRecs</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">gs</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">extEqualVectorGeneral</span> (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="var">m'</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l'</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m'</span>) : <span class="id" type="keyword">Prop</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">extEqualVector</span> (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l</span> <span class="id" type="var">l'</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span>) : <span class="id" type="keyword">Prop</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">extEqualVectorRefl</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span>), <span class="id" type="var">extEqualVector</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">l</span> <span class="id" type="var">l</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">extEqualOneParamList</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>)) <span class="id" type="var">m</span>) (<span class="id" type="var">c</span> : <span class="id" type="var">nat</span>),<br/>
&nbsp;<span class="id" type="var">extEqualVector</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> →<br/>
&nbsp;<span class="id" type="var">extEqualVector</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> (<span class="id" type="var">evalOneParamList</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">c</span> <span class="id" type="var">l1</span>) (<span class="id" type="var">evalOneParamList</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">c</span> <span class="id" type="var">l2</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">extEqualCompose</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">l1</span> <span class="id" type="var">l2</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span>) (<span class="id" type="var">f1</span> <span class="id" type="var">f2</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">m</span>),<br/>
&nbsp;<span class="id" type="var">extEqualVector</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> →<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">m</span> <span class="id" type="var">f1</span> <span class="id" type="var">f2</span> →<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">n</span> (<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">l1</span> <span class="id" type="var">f1</span>) (<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">l2</span> <span class="id" type="var">f2</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">extEqualCompose2</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">f1</span> <span class="id" type="var">f2</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>),<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">n</span> <span class="id" type="var">f1</span> <span class="id" type="var">f2</span> →<br/>
&nbsp;∀ <span class="id" type="var">g1</span> <span class="id" type="var">g2</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>),<br/>
&nbsp;<span class="id" type="var">extEqual</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) <span class="id" type="var">g1</span> <span class="id" type="var">g2</span> → <span class="id" type="var">extEqual</span> <span class="id" type="var">n</span> (<span class="id" type="var">compose2</span> <span class="id" type="var">n</span> <span class="id" type="var">f1</span> <span class="id" type="var">g1</span>) (<span class="id" type="var">compose2</span> <span class="id" type="var">n</span> <span class="id" type="var">f2</span> <span class="id" type="var">g2</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">extEqualPrimRec</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">g1</span> <span class="id" type="var">g2</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) (<span class="id" type="var">h1</span> <span class="id" type="var">h2</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>))),<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">n</span> <span class="id" type="var">g1</span> <span class="id" type="var">g2</span> →<br/>
&nbsp;<span class="id" type="var">extEqual</span> (<span class="id" type="var">S</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>)) <span class="id" type="var">h1</span> <span class="id" type="var">h2</span> →<br/>
&nbsp;<span class="id" type="var">extEqual</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) (<span class="id" type="var">evalPrimRecFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">g1</span> <span class="id" type="var">h1</span>) (<span class="id" type="var">evalPrimRecFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">g2</span> <span class="id" type="var">h2</span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">isPR</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) : <span class="id" type="keyword">Set</span> :=<br/>
&nbsp;&nbsp;{<span class="id" type="var">p</span> : <span class="id" type="var">PrimRec</span> <span class="id" type="var">n</span> | <span class="id" type="var">extEqual</span> <span class="id" type="var">n</span> (<span class="id" type="var">evalPrimRec</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span>) <span class="id" type="var">f</span>}.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">isPRrel</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">R</span> : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>) : <span class="id" type="keyword">Set</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">isPR</span> <span class="id" type="var">n</span> (<span class="id" type="var">charFunction</span> <span class="id" type="var">n</span> <span class="id" type="var">R</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">succIsPR</span> : <span class="id" type="var">isPR</span> 1 <span class="id" type="var">S</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">const0_NIsPR</span> : ∀ <span class="id" type="var">n</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 0 <span class="id" type="var">n</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">const1_NIsPR</span> : ∀ <span class="id" type="var">n</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">n</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">idIsPR</span> : <span class="id" type="var">isPR</span> 1 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">x</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pi1_2IsPR</span> : <span class="id" type="var">isPR</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pi2_2IsPR</span> : <span class="id" type="var">isPR</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pi1_3IsPR</span> : <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pi2_3IsPR</span> : <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pi3_3IsPR</span> : <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pi1_4IsPR</span> : <span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pi2_4IsPR</span> : <span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pi3_4IsPR</span> : <span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">pi4_4IsPR</span> : <span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">d</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter01IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter10IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter100IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter010IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter001IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter011IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter110IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter101IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">a</span> <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter0011IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter1000IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter1011IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">a</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">filter1100IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose1_1IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 1 <span class="id" type="var">f</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 1 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose1_2IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 1 <span class="id" type="var">f</span> →<br/>
&nbsp;∀ <span class="id" type="var">f'</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 1 <span class="id" type="var">f'</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 1 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span>) (<span class="id" type="var">f'</span> <span class="id" type="var">x</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose1_3IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f1</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 1 <span class="id" type="var">f1</span> →<br/>
&nbsp;∀ <span class="id" type="var">f2</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 1 <span class="id" type="var">f2</span> →<br/>
&nbsp;∀ <span class="id" type="var">f3</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 1 <span class="id" type="var">f3</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 1 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f1</span> <span class="id" type="var">x</span>) (<span class="id" type="var">f2</span> <span class="id" type="var">x</span>) (<span class="id" type="var">f3</span> <span class="id" type="var">x</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose2_1IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose2_2IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> →<br/>
&nbsp;∀ <span class="id" type="var">h</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">h</span> → <span class="id" type="var">isPR</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">h</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) (<span class="id" type="var">g</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose2_3IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f1</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f1</span> →<br/>
&nbsp;∀ <span class="id" type="var">f2</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f2</span> →<br/>
&nbsp;∀ <span class="id" type="var">f3</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f3</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f1</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) (<span class="id" type="var">f2</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) (<span class="id" type="var">f3</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose2_4IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f1</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f1</span> →<br/>
&nbsp;∀ <span class="id" type="var">f2</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f2</span> →<br/>
&nbsp;∀ <span class="id" type="var">f3</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f3</span> →<br/>
&nbsp;∀ <span class="id" type="var">f4</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f4</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 4 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f1</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) (<span class="id" type="var">f2</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) (<span class="id" type="var">f3</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) (<span class="id" type="var">f4</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose3_1IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">f</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose3_2IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f1</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">f1</span> →<br/>
&nbsp;∀ <span class="id" type="var">f2</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">f2</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f1</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>) (<span class="id" type="var">f2</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose3_3IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f1</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">f1</span> →<br/>
&nbsp;∀ <span class="id" type="var">f2</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">f2</span> →<br/>
&nbsp;∀ <span class="id" type="var">f3</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">f3</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f1</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>) (<span class="id" type="var">f2</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>) (<span class="id" type="var">f3</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose4_2IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f1</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 4 <span class="id" type="var">f1</span> →<br/>
&nbsp;∀ <span class="id" type="var">f2</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 4 <span class="id" type="var">f2</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> → <span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">w</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f1</span> <span class="id" type="var">w</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>) (<span class="id" type="var">f2</span> <span class="id" type="var">w</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose4_3IsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f1</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 4 <span class="id" type="var">f1</span> →<br/>
&nbsp;∀ <span class="id" type="var">f2</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 4 <span class="id" type="var">f2</span> →<br/>
&nbsp;∀ <span class="id" type="var">f3</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 4 <span class="id" type="var">f3</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">g</span> →<br/>
&nbsp;<span class="id" type="var">isPR</span> 4 (<span class="id" type="keyword">fun</span> <span class="id" type="var">w</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f1</span> <span class="id" type="var">w</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>) (<span class="id" type="var">f2</span> <span class="id" type="var">w</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>) (<span class="id" type="var">f3</span> <span class="id" type="var">w</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">swapIsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 2 <span class="id" type="var">f</span> → <span class="id" type="var">isPR</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">f</span> <span class="id" type="var">y</span> <span class="id" type="var">x</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">indIsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">f</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 1<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">nat_rec</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">nat</span>) <span class="id" type="var">g</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>) <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ind1ParamIsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 3 <span class="id" type="var">f</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> →<br/>
&nbsp;<span class="id" type="var">isPR</span> 2<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nat_rec</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">nat</span>) (<span class="id" type="var">g</span> <span class="id" type="var">b</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">b</span>) <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ind2ParamIsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 4 <span class="id" type="var">f</span> →<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>,<br/>
&nbsp;<span class="id" type="var">isPR</span> 2 <span class="id" type="var">g</span> →<br/>
&nbsp;<span class="id" type="var">isPR</span> 3<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">nat_rec</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">nat</span>) (<span class="id" type="var">g</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>) <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">plusIndIsPR</span> : <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> <span class="id" type="var">fn</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">S</span> <span class="id" type="var">fn</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">plusIsPR</span> : <span class="id" type="var">isPR</span> 2 <span class="id" type="var">plus</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">multIndIsPR</span> : <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> <span class="id" type="var">fn</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">fn</span> + <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">multIsPR</span> : <span class="id" type="var">isPR</span> 2 <span class="id" type="var">mult</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">predIsPR</span> : <span class="id" type="var">isPR</span> 1 <span class="id" type="var">pred</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">minusIndIsPR</span> : <span class="id" type="var">isPR</span> 3 (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> <span class="id" type="var">fn</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">pred</span> <span class="id" type="var">fn</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">minusIsPR</span> : <span class="id" type="var">isPR</span> 2 <span class="id" type="var">minus</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">notZero</span> (<span class="id" type="var">a</span> : <span class="id" type="var">nat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">nat_rec</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">nat</span>) 0 (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ 1) <span class="id" type="var">a</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">notZeroIsPR</span> : <span class="id" type="var">isPR</span> 1 <span class="id" type="var">notZero</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">ltBool</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span>) : <span class="id" type="var">bool</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ltBoolTrue</span> : ∀ <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">ltBool</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> = <span class="id" type="var">true</span> → <span class="id" type="var">a</span> &lt; <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ltBoolFalse</span> : ∀ <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">ltBool</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> = <span class="id" type="var">false</span> → ¬ <span class="id" type="var">a</span> &lt; <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ltIsPR</span> : <span class="id" type="var">isPRrel</span> 2 <span class="id" type="var">ltBool</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">maxIsPR</span> : <span class="id" type="var">isPR</span> 2 <span class="id" type="var">max</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">gtIsPR</span> : <span class="id" type="var">isPRrel</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">ltBool</span> <span class="id" type="var">b</span> <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Remark</span> <span class="id" type="var">replaceCompose2</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">a'</span> <span class="id" type="var">b'</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) (<span class="id" type="var">c</span> <span class="id" type="var">c'</span> : <span class="id" type="var">naryFunc</span> 2),<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">a'</span> →<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">n</span> <span class="id" type="var">b</span> <span class="id" type="var">b'</span> →<br/>
&nbsp;<span class="id" type="var">extEqual</span> 2 <span class="id" type="var">c</span> <span class="id" type="var">c'</span> →<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">n</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">Vcons</span> <span class="id" type="var">_</span> <span class="id" type="var">a</span> <span class="id" type="var">_</span> (<span class="id" type="var">Vcons</span> <span class="id" type="var">_</span> <span class="id" type="var">b</span> <span class="id" type="var">_</span> (<span class="id" type="var">Vnil</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>)))) <span class="id" type="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">Vcons</span> <span class="id" type="var">_</span> <span class="id" type="var">a'</span> <span class="id" type="var">_</span> (<span class="id" type="var">Vcons</span> <span class="id" type="var">_</span> <span class="id" type="var">b'</span> <span class="id" type="var">_</span> (<span class="id" type="var">Vnil</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>)))) <span class="id" type="var">c'</span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">orRel</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">R</span> <span class="id" type="var">S</span> : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>) : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">orRelPR</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">R</span> <span class="id" type="var">R'</span> : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>),<br/>
&nbsp;<span class="id" type="var">isPRrel</span> <span class="id" type="var">n</span> <span class="id" type="var">R</span> → <span class="id" type="var">isPRrel</span> <span class="id" type="var">n</span> <span class="id" type="var">R'</span> → <span class="id" type="var">isPRrel</span> <span class="id" type="var">n</span> (<span class="id" type="var">orRel</span> <span class="id" type="var">n</span> <span class="id" type="var">R</span> <span class="id" type="var">R'</span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">andRel</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">R</span> <span class="id" type="var">S</span> : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>) : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">andRelPR</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">R</span> <span class="id" type="var">R'</span> : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>),<br/>
&nbsp;<span class="id" type="var">isPRrel</span> <span class="id" type="var">n</span> <span class="id" type="var">R</span> → <span class="id" type="var">isPRrel</span> <span class="id" type="var">n</span> <span class="id" type="var">R'</span> → <span class="id" type="var">isPRrel</span> <span class="id" type="var">n</span> (<span class="id" type="var">andRel</span> <span class="id" type="var">n</span> <span class="id" type="var">R</span> <span class="id" type="var">R'</span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">notRel</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">R</span> : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>) : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">notRelPR</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">R</span> : <span class="id" type="var">naryRel</span> <span class="id" type="var">n</span>), <span class="id" type="var">isPRrel</span> <span class="id" type="var">n</span> <span class="id" type="var">R</span> → <span class="id" type="var">isPRrel</span> <span class="id" type="var">n</span> (<span class="id" type="var">notRel</span> <span class="id" type="var">n</span> <span class="id" type="var">R</span>).<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">bodd</span> (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) : <span class="id" type="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">O</span> ⇒ <span class="id" type="var">false</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">n'</span> ⇒ <span class="id" type="var">negb</span> (<span class="id" type="var">bodd</span> <span class="id" type="var">n'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">boddIsPR</span> : <span class="id" type="var">isPRrel</span> 1 <span class="id" type="var">bodd</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">beq_nat_not_refl</span> : ∀ <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">a</span> ≠ <span class="id" type="var">b</span> → <span class="id" type="var">beq_nat</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> = <span class="id" type="var">false</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">neqIsPR</span> : <span class="id" type="var">isPRrel</span> 2 (<span class="id" type="keyword">fun</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">negb</span> (<span class="id" type="var">beq_nat</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">eqIsPR</span> : <span class="id" type="var">isPRrel</span> 2 <span class="id" type="var">beq_nat</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">leBool</span> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span>) : <span class="id" type="var">bool</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">leIsPR</span> : <span class="id" type="var">isPRrel</span> 2 <span class="id" type="var">leBool</span>.<br/>

<br/>
<span class="id" type="keyword">Section</span> <span class="id" type="var">Ignore_Params</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">ignoreParams</span> (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">m</span>} :<br/>
&nbsp;<span class="id" type="var">naryFunc</span> (<span class="id" type="var">m</span> + <span class="id" type="var">n</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">m</span> <span class="id" type="keyword">return</span> (<span class="id" type="var">naryFunc</span> (<span class="id" type="var">m</span> + <span class="id" type="var">n</span>)) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">O</span> ⇒ <span class="id" type="var">f</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">ignoreParams</span> <span class="id" type="var">n</span> <span class="id" type="var">x</span> <span class="id" type="var">f</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">projectionListPR</span> (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">p</span> : <span class="id" type="var">m</span> ≤ <span class="id" type="var">n</span>) : <span class="id" type="var">PrimRecs</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">projectionList</span> (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">p</span> : <span class="id" type="var">m</span> ≤ <span class="id" type="var">n</span>) : <br/>
&nbsp;&nbsp;<span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span> := <span class="id" type="var">evalPrimRecs</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> (<span class="id" type="var">projectionListPR</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">p</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">projectionListInd</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">p1</span> <span class="id" type="var">p2</span> : <span class="id" type="var">m</span> ≤ <span class="id" type="var">n</span>),<br/>
&nbsp;<span class="id" type="var">projectionList</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">p1</span> = <span class="id" type="var">projectionList</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">p2</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">projectionListApplyParam</span> :<br/>
&nbsp;∀ (<span class="id" type="var">m</span> <span class="id" type="var">n</span> <span class="id" type="var">c</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">p1</span> : <span class="id" type="var">m</span> ≤ <span class="id" type="var">n</span>) (<span class="id" type="var">p2</span> : <span class="id" type="var">m</span> ≤ <span class="id" type="var">S</span> <span class="id" type="var">n</span>),<br/>
&nbsp;<span class="id" type="var">extEqualVector</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">projectionList</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">p1</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">evalOneParamList</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">c</span> (<span class="id" type="var">projectionList</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span> <span class="id" type="var">p2</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">projectionListId</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) (<span class="id" type="var">p</span> : <span class="id" type="var">n</span> ≤ <span class="id" type="var">n</span>),<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">n</span> <span class="id" type="var">f</span> (<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">n</span> (<span class="id" type="var">projectionList</span> <span class="id" type="var">n</span> <span class="id" type="var">n</span> <span class="id" type="var">p</span>) <span class="id" type="var">f</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">ignoreParamsIsPR</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>), <span class="id" type="var">isPR</span> <span class="id" type="var">_</span> <span class="id" type="var">f</span> → <span class="id" type="var">isPR</span> <span class="id" type="var">_</span> (<span class="id" type="var">ignoreParams</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">f</span>).<br/>

<br/>
<span class="id" type="keyword">End</span> <span class="id" type="var">Ignore_Params</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">reduce1stCompose</span> :<br/>
&nbsp;∀ (<span class="id" type="var">c</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">v</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span>) (<span class="id" type="var">g</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">m</span>)),<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">n</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">_</span> (<span class="id" type="var">Vcons</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) (<span class="id" type="var">evalConstFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">c</span>) <span class="id" type="var">_</span> <span class="id" type="var">v</span>) <span class="id" type="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">_</span> <span class="id" type="var">v</span> (<span class="id" type="var">g</span> <span class="id" type="var">c</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">reduce2ndCompose</span> :<br/>
&nbsp;∀ (<span class="id" type="var">c</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">v</span> : <span class="id" type="var">vector</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">m</span>) (<span class="id" type="var">n0</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">g</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> (<span class="id" type="var">S</span> <span class="id" type="var">m</span>))),<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">n</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">Vcons</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">n0</span> <span class="id" type="var">_</span> (<span class="id" type="var">Vcons</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) (<span class="id" type="var">evalConstFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">c</span>) <span class="id" type="var">_</span> <span class="id" type="var">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">evalComposeFunc</span> <span class="id" type="var">n</span> <span class="id" type="var">_</span> (<span class="id" type="var">Vcons</span> (<span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) <span class="id" type="var">n0</span> <span class="id" type="var">_</span> <span class="id" type="var">v</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> <span class="id" type="var">x</span> <span class="id" type="var">c</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">evalPrimRecParam</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">g</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>)) (<span class="id" type="var">h</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> (<span class="id" type="var">S</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>)))),<br/>
&nbsp;<span class="id" type="var">extEqual</span> <span class="id" type="var">_</span> (<span class="id" type="var">evalPrimRecFunc</span> <span class="id" type="var">n</span> (<span class="id" type="var">g</span> <span class="id" type="var">d</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">h</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">d</span>) <span class="id" type="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">evalPrimRecFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) <span class="id" type="var">g</span> <span class="id" type="var">h</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose2IsPR</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">f</span> : <span class="id" type="var">naryFunc</span> <span class="id" type="var">n</span>) (<span class="id" type="var">p</span> : <span class="id" type="var">isPR</span> <span class="id" type="var">n</span> <span class="id" type="var">f</span>) (<span class="id" type="var">g</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>))<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">q</span> : <span class="id" type="var">isPR</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) <span class="id" type="var">g</span>), <span class="id" type="var">isPR</span> <span class="id" type="var">n</span> (<span class="id" type="var">compose2</span> <span class="id" type="var">n</span> <span class="id" type="var">f</span> <span class="id" type="var">g</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">compose1_NIsPR</span> :<br/>
&nbsp;∀ (<span class="id" type="var">n</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">g</span> : <span class="id" type="var">naryFunc</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>)),<br/>
&nbsp;<span class="id" type="var">isPR</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) <span class="id" type="var">g</span> →<br/>
&nbsp;∀ <span class="id" type="var">f</span> : <span class="id" type="var">naryFunc</span> 1, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">f</span> → <span class="id" type="var">isPR</span> (<span class="id" type="var">S</span> <span class="id" type="var">n</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span>)).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">switchPR</span> : <span class="id" type="var">naryFunc</span> 3.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">switchIsPR</span> : <span class="id" type="var">isPR</span> 3 <span class="id" type="var">switchPR</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <span class="id" type="var">boundedSearchHelp</span> (<span class="id" type="var">P</span> : <span class="id" type="var">naryRel</span> 1) (<span class="id" type="var">b</span> : <span class="id" type="var">nat</span>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">b</span>} : <span class="id" type="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">b</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">O</span> ⇒ 0<br/>
&nbsp;&nbsp;| <span class="id" type="var">S</span> <span class="id" type="var">b'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">eq_nat_dec</span> (<span class="id" type="var">boundedSearchHelp</span> <span class="id" type="var">P</span> <span class="id" type="var">b'</span>) <span class="id" type="var">b'</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">left</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="keyword">match</span> <span class="id" type="var">P</span> <span class="id" type="var">b'</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">true</span> ⇒ <span class="id" type="var">b'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">false</span> ⇒ <span class="id" type="var">S</span> <span class="id" type="var">b'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">right</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">boundedSearchHelp</span> <span class="id" type="var">P</span> <span class="id" type="var">b'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">boundedSearch</span> (<span class="id" type="var">P</span> : <span class="id" type="var">naryRel</span> 2) (<span class="id" type="var">b</span> : <span class="id" type="var">nat</span>) : <span class="id" type="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">boundedSearchHelp</span> (<span class="id" type="var">P</span> <span class="id" type="var">b</span>) <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">boundedSearch1</span> :<br/>
&nbsp;∀ (<span class="id" type="var">P</span> : <span class="id" type="var">naryRel</span> 2) (<span class="id" type="var">b</span> <span class="id" type="var">x</span> : <span class="id" type="var">nat</span>), <span class="id" type="var">x</span> &lt; <span class="id" type="var">boundedSearch</span> <span class="id" type="var">P</span> <span class="id" type="var">b</span> → <span class="id" type="var">P</span> <span class="id" type="var">b</span> <span class="id" type="var">x</span> = <span class="id" type="var">false</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">boundedSearch2</span> :<br/>
&nbsp;∀ (<span class="id" type="var">P</span> : <span class="id" type="var">naryRel</span> 2) (<span class="id" type="var">b</span> : <span class="id" type="var">nat</span>),<br/>
&nbsp;<span class="id" type="var">boundedSearch</span> <span class="id" type="var">P</span> <span class="id" type="var">b</span> = <span class="id" type="var">b</span> ∨ <span class="id" type="var">P</span> <span class="id" type="var">b</span> (<span class="id" type="var">boundedSearch</span> <span class="id" type="var">P</span> <span class="id" type="var">b</span>) = <span class="id" type="var">true</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">boundSearchIsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">P</span> : <span class="id" type="var">naryRel</span> 2,<br/>
&nbsp;<span class="id" type="var">isPRrel</span> 2 <span class="id" type="var">P</span> → <span class="id" type="var">isPR</span> 1 (<span class="id" type="keyword">fun</span> <span class="id" type="var">b</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">boundedSearch</span> <span class="id" type="var">P</span> <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="var">iterate</span> (<span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">nat_rec</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>) (<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <span class="id" type="var">nat</span> ⇒ <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> (<span class="id" type="var">_</span> : <span class="id" type="var">nat</span>) (<span class="id" type="var">rec</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>) (<span class="id" type="var">x</span> : <span class="id" type="var">nat</span>) ⇒ <span class="id" type="var">g</span> (<span class="id" type="var">rec</span> <span class="id" type="var">x</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <span class="id" type="var">iterateIsPR</span> :<br/>
&nbsp;∀ <span class="id" type="var">g</span> : <span class="id" type="var">nat</span> → <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 <span class="id" type="var">g</span> → ∀ <span class="id" type="var">n</span> : <span class="id" type="var">nat</span>, <span class="id" type="var">isPR</span> 1 (<span class="id" type="var">iterate</span> <span class="id" type="var">g</span> <span class="id" type="var">n</span>).<br/>
</div>
<hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>